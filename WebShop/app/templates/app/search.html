{% extends 'app/base.html' %}
<title>{% block title %}Search Results{% endblock %}</title>
{% load widget_tweaks %}
{% load static %}

{% block Register %}
<div class="container-fluid my-5 px-5">
  <h4 class="mb-4">
    üîé K·∫øt qu·∫£ t√¨m ki·∫øm cho: 
    <span class="text-primary">"{{ searched }}"</span>
  </h4>

  {% if keys %}
    <div class="row text-center">
      {% for item in keys %}
      <!-- üîπ Card s·∫£n ph·∫©m -->
      <div class="col-md-6 col-lg-3 mb-5">
        <div class="card shadow-lg border-0 h-100 rounded-4 overflow-hidden">
          
          <!-- üîπ ·∫¢nh s·∫£n ph·∫©m (c√≥ hi·ªáu ·ª©ng hover) -->
          <a href="{% url 'product_detail' item.id %}" class="img-hover">
            <img src="{{ item.ImageURL }}" class="product-img" alt="{{ item.name }}">
          </a>

          <!-- üîπ N·ªôi dung s·∫£n ph·∫©m -->
          <div class="card-body d-flex flex-column">
            <h5 class="card-title fw-bold text-truncate">{{ item.name }}</h5>
            <p class="card-text">{{ item.description|default:"(Ch∆∞a c√≥ m√¥ t·∫£)" }}</p>

            <!-- üîπ N√∫t mua h√†ng + Gi√° -->
            <div class="d-flex justify-content-between align-items-center mt-auto">
              <a href="#"
                 class="btn btn-success update-cart px-3"
                 data-product="{{ item.id }}"
                 data-action="add">
                 üõí Th√™m v√†o gi·ªè
              </a>
              <h5 class="text-danger fw-bold m-0">
                ${{ item.price|floatformat:0 }}
              </h5>
            </div>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
  {% else %}
    <!-- üîπ Kh√¥ng t√¨m th·∫•y s·∫£n ph·∫©m -->
    <div class="alert alert-warning text-center rounded-4 shadow-sm">
      üò• Kh√¥ng t√¨m th·∫•y s·∫£n ph·∫©m n√†o kh·ªõp v·ªõi t·ª´ kh√≥a 
      <strong>"{{ searched }}"</strong>.
    </div>
  {% endif %}

  {% if image_results %} <!-- Ki·ªÉm tra n·∫øu c√≥ k·∫øt qu·∫£ t·ª´ Milvus -->
  <hr class="my-5">
  <h4 class="mb-4">üñº G·ª£i √Ω s·∫£n ph·∫©m t∆∞∆°ng t·ª± b·∫±ng Milvus vector search:</h4>
  <div class="row text-center">
    {% for hit in image_results %} 
    <div class="col-md-3 mb-4">
      <div class="card shadow-sm border-0 rounded-3">
        <img src="{% static hit.filepath %}" class="product-img" alt="Similar product"> <!-- S·ª≠ d·ª•ng static cho ·∫£nh tƒ©nh -->
      </div>
    </div>
    {% endfor %}
  </div>
  {% endif %}
</div>

<!-- ‚úÖ CSS cho ·∫£nh s·∫£n ph·∫©m -->
<style>
  /* Hi·ªáu ·ª©ng hover */
  .img-hover img {
    transition: transform 0.4s ease;
  }
  .img-hover img:hover {
    transform: scale(1.08);
  }

  /* C·ªë ƒë·ªãnh k√≠ch th∆∞·ªõc ·∫£nh ƒë·ªÉ ƒë·ªìng ƒë·ªÅu */
  .product-img {
    height: 250px;       /* ch·ªânh cao th·∫•p t√πy √Ω, v√≠ d·ª• 250px */
    object-fit: cover;   /* gi·ªØ t·ªâ l·ªá, c·∫Øt ph·∫ßn d∆∞ */
    width: 100%;
    border-top-left-radius: 0.5rem;
    border-top-right-radius: 0.5rem;
  }
</style>

{% endblock Register %}
